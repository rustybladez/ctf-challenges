import socket
import time

# Define the server details
HOST = "34.45.235.239"
PORT = 8004

# Pre-verified 22 valid pairs
valid_pairs = [
    ("307549684c4c57506449663674646e77", "f0a290e587a770ec"),
    ("6a484950323877326964624c75754257", "b5f339427373ca06"),
    ("7542414563464f694a34563578566b71", "e5bc2897f54ecab7"),
    ("664450647353584d566137776444554f", "5f79c5bbc0c8f5a2"),
    ("696d6e72363436645443744157315330", "9e348ef3687539fe"),
    ("4f4c4f75337579764371467a6e657031", "3f1423bd51047e98"),
    ("4a79346f754b59436565677434585041", "2b2ec3a44ef0c28d"),
    ("624236614376345a41436b54766a4154", "64b2f3fd1d4178ac"),
    ("473036797142715755436d704e565850", "08fb3fd2fb46b536"),
    ("564367356f5642703430334a5a764237", "5a97829cde1d3c61"),
    ("4b44786d78614b4d7135645156515a38", "5ead6e4ac3401909"),
    ("33624e5a5a5571394a6755657a333837", "ef6f4d9291a70c9c"),
    ("4a4f65586f7a666a366b633469545949", "026586435c2b13c7"),
    ("346c33654e61584333494c7350743569", "bfc9e328aa4fbe2b"),
    ("4b624553384a724a574a544a71433438", "4c3a6e258e834a62"),
    ("4678526e494a485a7279746e65676e6a", "cdf1f181d0901e6e"),
    ("7a4f33323458614c6f69664f5751744a", "929ab72cac812b11"),
    ("726a74573770796162384d6c78566470", "1a0d5da84c605309"),
    ("71764c35784c7859644e53463552366f", "8b887efd806235e5"),
    ("747a7a48764f56455566356c4277696e", "86b9128a4dab045e"),
    ("46735576467469794758534830476f64", "f4dfe29535dbd09b"),
    ("434b7378314c626b6244367247387751", "902c5a37d7544b50"),
    ("646556367a794d45376a306335437341", "0ff4e046a350ba4d"),
    ("613836476237483041334b417449794d", "f9dc76da4b55f55e"),
    ("457879616533646b3377377769647672", "b821334755553e06"),
    ("554531544f4e744d4934395367536562", "ada9d5b617d85696"),
    ("5653303265476f39676a65514c475972", "79cb6233e2968d8a"),
    ("5247486552776e4a586a455258546252", "48c3edfbe0d18db9"),
    ("534542327355424d374c633339545655", "96dd731b1e0be43f"),
    ("517449574f527a75324941495a7a4970", "1c71ceb5b229ea79"),
    ("6e5a6f513878654b6c6f555573453031", "2e32562564afc0aa"),
    ("48313768474673547475496169536d36", "b5bd7a7b17907cf9"),
    ("436869746b4f436a34514e447432354d", "9d9167ddf4b046c4"),
    ("79725442536c3734516d356b4f6c5377", "fa82ec922c017728"),
    ("65773569693575666c46347a6c64717a", "f5a1b67914a9c85a"),
    ("4136496942355a7a33576c7442314542", "30118c85582f2fa1"),
    ("4f594d386c6e34726c484474796f3331", "36e2a3f2638ec0dd"),
    ("39704b4a6739474c3071316157485567", "e79aa825a476aaf2"),
    ("72704a70375231437256703531706c6e", "6eb07e5442c1d794"),
    ("36456570507646467136797055434558", "999a9549339cf1b2"),
    ("617776416d34584539324a356a416d76", "30de4e5eb58c4430"),
    ("674b5541747771456772783162666736", "62d873d6241b0286"),
    ("316c4763336577633845727968757456", "2465c411eb5d35cd"),
    ("4d497378595a79346265787636617245", "05259c2f5e594bff"),
    ("62677234436d55474844417944446d46", "f83aed7003a7fd4c"),
    ("37575a53734968313758636d68723071", "a973535c9d17fe82"),
    ("684c786b6a6f4e575975465278705039", "2b4d24059f435686"),
    ("387267394b4a4c3864485a5056384767", "0371cb8576c125b9"),
    ("4f544f786f62754c6154626465506343", "cc08fc4108885bdf"),
    ("68565644714d3970344e475447385843", "f60dff24a5717caa"),
    ("6a594679667a635945634d5a6e665047", "6738ddfc3226919f"),
    ("5a55526d4575717552616b4659666836", "d75286554ecfb18e"),
    ("454e3364745358746a7669494c5a5233", "9471755fc8dae6bf"),
    ("473854594a365a71575646374e686164", "2373151d9b13bbd2"),
    ("3963724558434c436637784349384366", "0e7d78e90137fa9f"),
    ("55744577725376434a5343317579786f", "fafad928b43b9bc3"),
    ("5a694f6871395369626558316d633567", "99188a07a911b314"),
    ("6d6a6f50515a6c73347a435a4c44616e", "0b52c4a763a397fa"),
    ("726133744b4564777946464535783639", "435cb1336720b39e"),
    ("4b7a4f77535651596f64336837686550", "2fa263bd5ad63a30"),
    ("496f5254526359756b71335037666351", "0a1500477caab6a5"),
    ("4d7272454b366d63733575776c436945", "a81c521be53b9715"),
    ("7745346d316a4a6c5630464c42576e59", "c96e8c80e2f32f23"),
    ("3465683369596d3872644e6a536d7544", "28f35f9754bb860a")
]

# Function to interact with the server
def interact_with_server():
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.connect((HOST, PORT))
        print(s.recv(1024).decode())  # Read the welcome message

        successes = 0
        attempt = 1

        # Submit pre-verified pairs first
        for message, token in valid_pairs:
            print(f"Attempt {attempt}: Submitting pre-verified pair")
            s.sendall(f"{message} {token}\n".encode())
            response = s.recv(1024).decode().strip()
            print(response)
            if "Success!" in response:
                successes += 1
            attempt += 1

        # Check if we succeeded
        if successes >= 64:
            print("\nCongratulations! Challenge completed.")
            print(s.recv(1024).decode())  # Print the flag
        else:
            print("\nFailed to complete the challenge.")

# Run the script
if __name__ == "__main__":
    interact_with_server()
